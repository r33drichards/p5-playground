<!DOCTYPE html>
<html>

<head>
    <title>L-System Renderer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>

<style>
    body {
        margin: 0;
        padding: 0;
        overflow: hidden;
    }
</style>

<script>
    let axiom = "F";
    let rules = [

        {
            pre: "F",
            next: "FF-[XY]+[XY]"
        },
        {
            pre: "X",
            next: "+FY"
        },
        {
            pre: "Y",
            next: "-FX"
        }

    ];
    let sentence = axiom;
    let len = 256;
    let angle;

    function setup() {
        createCanvas(windowWidth, windowHeight);
        background(255);
        angle = radians(45);
    }

    let generations = 6;

    function draw() {
        // nothing to draw continuously
        applyRules();
        background(255);
        turtle(width/1.5, height);
        // turtle(width/4, height);

        generations--;
        if (generations === 0) {
            noLoop();
        }
    }

    function turtle(x, y) {
        translate(x, y);
        stroke(0);
        noFill();
        for (let i = 0; i < sentence.length; i++) {
            let current = sentence.charAt(i);
            if (current === "F") {
                stroke(0);
                line(0, 0, 0, -len);
                translate(0, -len);
            } else if (current === "+") {
                rotate(angle);
            } else if (current === "-") {
                rotate(-angle);
            } else if (current === "[") {
                push();
            } else if (current === "]") {
                pop();
            }
        }
    }

    function applyRules() {
        let nextSentence = "";
        for (let i = 0; i < sentence.length; i++) {
            let current = sentence.charAt(i);
            let replaced = false;
            for (let j = 0; j < rules.length; j++) {
                if (current === rules[j].pre) {
                    nextSentence += rules[j].next;
                    replaced = true;
                    break;
                }
            }
            if (!replaced) {
                nextSentence += current;
            }
        }
        sentence = nextSentence;
        len *= 0.5;
    }


</script>

<body>
</body>

</html>